version: "3"

vars:
  PYTHON: python3
  VENV_DIR: .venv
  SRC_DIR: src
  TESTS_DIR: tests

tasks:
  build:
    desc: "Build package distribution"
    cmds:
      - "python3 -m build"

  clean:
    desc: "Clean up build artifacts, cache files, and temporary files"
    cmds:
      - rm -rf build/
      - rm -rf dist/
      - rm -rf *.egg-info/
      - rm -rf .pytest_cache/
      - rm -rf htmlcov/
      - rm -rf .coverage
      - rm -rf .ruff_cache/
      - rm -rf src/__pycache__/
      - rm -rf tests/__pycache__/

  build:clean:
    desc: "Clean build artifacts and rebuild"
    cmds:
      - task: clean
      - task: build
  test:cov:
    desc: "Run tests with coverage report"
    cmds:
      - "{{.VENV_DIR}}/bin/python -m pytest {{.TESTS_DIR}}/  --cov-report=term-missing --cov-report=html:calc_cov --cov-report=xml --cov"